<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>RISE 15-Minute Memory Trainer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      padding: 20px;
      max-width: 720px;
      margin: auto;
      line-height: 1.35;
    }
    h1, h2 {
      text-align: center;
      margin: 8px 0;
    }
    p {
      margin: 8px 0;
    }
    .sub {
      text-align: center;
      opacity: 0.9;
      margin-bottom: 18px;
    }
    .timer {
      text-align: center;
      font-size: 38px;
      margin: 16px 0 10px;
      letter-spacing: 1px;
    }
    .row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 12px;
    }
    button {
      padding: 12px 14px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      background: #22c55e;
      color: #000;
      cursor: pointer;
      min-width: 220px;
    }
    button.secondary {
      background: #38bdf8;
      color: #001018;
      min-width: 220px;
    }
    button.ghost {
      background: #334155;
      color: #e5e7eb;
      min-width: 220px;
    }
    .streak {
      text-align: center;
      margin-top: 6px;
      font-weight: bold;
    }
    .step {
      margin: 14px 0;
      padding: 14px;
      background: #1e293b;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    .step h2 {
      margin: 6px 0 10px;
      font-size: 20px;
    }
    .helper {
      font-size: 14px;
      opacity: 0.9;
      margin: 0 0 10px;
      text-align: left;
    }
    textarea {
      width: 100%;
      min-height: 70px;
      border-radius: 10px;
      border: none;
      padding: 10px;
      margin-top: 6px;
      font-size: 15px;
      resize: vertical;
    }
    ul {
      margin: 10px 0 0 18px;
    }
    li {
      margin: 6px 0;
    }
    details summary {
      cursor: pointer;
      font-weight: bold;
      font-size: 16px;
    }
    .small {
      font-size: 13px;
      opacity: 0.9;
    }
    .footer-space {
      height: 18px;
    }
  </style>
</head>

<body>
  <h1>RISE 15-Minute Memory Trainer</h1>
  <div class="sub">Retrieve ‚Ä¢ Interleave ‚Ä¢ Space ‚Ä¢ Elaborate</div>

  <div class="timer" id="timer">15:00</div>

  <div class="row">
    <button onclick="startTimer()">Start Session</button>
    <button class="ghost" onclick="resetTimer()">Reset Timer</button>
  </div>

  <div class="streak" id="streak">üî• Current RISE Streak: 0 day(s)</div>

  <!-- Clarity Panel -->
  <div class="step">
    <details open>
      <summary>üß≠ When memory feels blank</summary>
      <p class="helper">
        This app is <b>not testing you</b>. It is training you.<br><br>
        ‚Ä¢ Forgetting is expected<br>
        ‚Ä¢ Attempting recall is the workout<br>
        ‚Ä¢ Fragments are progress<br>
        ‚Ä¢ Speaking imperfectly builds clarity<br><br>
        If nothing comes to mind yet, write that ‚Äî then continue.
      </p>
      <p class="small">
        Tip: Replace ‚Äúyesterday‚Äù with ‚Äúmy last session‚Äù (even if it was days ago).
      </p>
    </details>
  </div>

  <!-- Intent Lock -->
  <div class="step">
    <h2>Intent Lock</h2>
    <p class="helper">What is the <b>one idea</b> you want to walk away remembering today?</p>
    <textarea id="intentInput" placeholder="One idea I must remember today is..."></textarea>
  </div>

  <!-- Retrieve -->
  <div class="step">
    <h2>Retrieve ‚Äî What comes to mind?</h2>
    <p class="helper">
      From your <b>last session</b> (even if it was days ago), write anything that comes to mind.
      ‚ÄúNothing clear yet‚Äù is valid.
    </p>
    <textarea id="retrieveInput" placeholder="Fragments, keywords, or: 'Nothing clear yet.'"></textarea>
    <div class="row" style="margin-top:10px;">
      <button class="secondary" onclick="handleNoRecall()">I don‚Äôt remember yet ‚Äî guide me</button>
    </div>
  </div>

  <!-- 2-Sentence Summary -->
  <div class="step">
    <h2>2-Sentence Summary</h2>
    <p class="helper">
      If you can, say this out loud. One imperfect sentence is enough.
      <br>Format: ‚ÄúI learned ___ because ___. This matters because ___.‚Äù
    </p>
    <textarea id="summaryInput" placeholder="I learned ___ because ___. This matters because ___."></textarea>
  </div>

  <!-- Interleave: Contrast -->
  <div class="step">
    <h2>Interleave ‚Äî Contrast</h2>
    <p class="helper">How is this different from a related idea you‚Äôve encountered before?</p>
    <textarea id="contrastInput" placeholder="This differs from ___ because..."></textarea>
  </div>

  <!-- Interleave: Real-life link -->
  <div class="step">
    <h2>Interleave ‚Äî Real-life Link</h2>
    <p class="helper">Where does this show up in real life (work, family, goals, leadership, health)?</p>
    <textarea id="reallifeInput" placeholder="This shows up in real life when..."></textarea>
  </div>

  <!-- Space: Older recall -->
  <div class="step">
    <h2>Space ‚Äî Older Recall</h2>
    <p class="helper">Recall one idea from earlier this week (or a previous session). No notes.</p>
    <textarea id="olderRecallInput" placeholder="From earlier this week / previous sessions, I remember..."></textarea>
  </div>

  <!-- One-Line Anchor -->
  <div class="step">
    <h2>One-Line Anchor</h2>
    <p class="helper">
      Write the single sentence that will survive. Keep it short and strong.
      This is what the Weekly Review will store.
    </p>
    <textarea id="anchorInput" placeholder="If I forget everything else, remember this..."></textarea>
  </div>

  <!-- Teach It Simply -->
  <div class="step">
    <h2>Teach It Simply</h2>
    <p class="helper">
      Explain this out loud as if to a friend or a 12-year-old.
      Messy explanations are how fluency develops.
    </p>
    <textarea id="teachInput" placeholder="Simple explanation + example + analogy..."></textarea>
  </div>

  <!-- 48-hour Application -->
  <div class="step">
    <h2>48-Hour Application</h2>
    <p class="helper">What small action in the next 48 hours proves you understood this?</p>
    <textarea id="applyInput" placeholder="Within 48 hours I will apply this by..."></textarea>
  </div>

  <!-- Complete -->
  <div class="row">
    <button onclick="completeSession()">Complete Session</button>
    <button class="ghost" onclick="clearTextboxes()">Clear Text Boxes</button>
  </div>

  <!-- Weekly Review -->
  <div class="step">
    <h2>üìÖ Weekly Review (Last 7 Anchors)</h2>
    <p class="helper">
      Speak these out loud without notes. For each anchor:
      What does it mean? Why does it matter? Where did/will you apply it?
    </p>
    <ul id="weeklyList"></ul>
    <p class="small">
      If you miss a day, no problem. Continue. Consistency is built by returning.
    </p>
  </div>

  <div class="footer-space"></div>

  <script>
    // --- Timer ---
    let time = 900; // 15 minutes
    let timerInterval;

    function renderTime() {
      const minutes = Math.floor(time / 60);
      const seconds = time % 60;
      document.getElementById("timer").textContent =
        `${minutes}:${seconds < 10 ? "0" : ""}${seconds}`;
    }

    function startTimer() {
      clearInterval(timerInterval);
      // If someone paused at 0, restart fresh:
      if (time <= 0) time = 900;
      timerInterval = setInterval(() => {
        renderTime();
        time--;
        if (time < 0) {
          clearInterval(timerInterval);
          time = 0;
          renderTime();
        }
      }, 1000);
    }

    function resetTimer() {
      clearInterval(timerInterval);
      time = 900;
      renderTime();
    }

    // --- Support flow for "no recall" days ---
    function handleNoRecall() {
      alert(
        "That‚Äôs normal ‚Äî this is training.\n\n" +
        "Do this:\n" +
        "1) In the box, write: 'Nothing clear yet.'\n" +
        "2) Skim headings/highlights for 10‚Äì30 seconds (not full rereading).\n" +
        "3) Say one messy sentence out loud: 'I think it was about ___, and it mattered because ___.'\n\n" +
        "Then continue the session."
      );

      // Help the user by inserting a starter phrase if empty
      const r = document.getElementById("retrieveInput");
      if (!r.value.trim()) r.value = "Nothing clear yet.";
      r.focus();
    }

    // --- Streak + Weekly Anchors ---
    function getTodayISO() {
      return new Date().toISOString().split("T")[0];
    }

    function updateStreakDisplay() {
      const streak = localStorage.getItem("riseStreak") || 0;
      document.getElementById("streak").textContent =
        `üî• Current RISE Streak: ${streak} day(s)`;
    }

    function loadWeeklyReview() {
      const anchors = JSON.parse(localStorage.getItem("riseAnchors")) || [];
      const lastSeven = anchors.slice(-7).reverse();
      const list = document.getElementById("weeklyList");
      list.innerHTML = "";

      if (lastSeven.length === 0) {
        const li = document.createElement("li");
        li.textContent = "No anchors saved yet. Complete your first session to start building your weekly review.";
        list.appendChild(li);
        return;
      }

      lastSeven.forEach(item => {
        const li = document.createElement("li");
        li.textContent = `${item.date}: ${item.text}`;
        list.appendChild(li);
      });
    }

    function completeSession() {
      const today = getTodayISO();

      // Streak logic
      const lastDate = localStorage.getItem("riseLastDate");
      let streak = parseInt(localStorage.getItem("riseStreak")) || 0;

      if (lastDate !== today) {
        streak++;
        localStorage.setItem("riseStreak", streak);
        localStorage.setItem("riseLastDate", today);
      }

      // Save One-Line Anchor
      const anchors = JSON.parse(localStorage.getItem("riseAnchors")) || [];
      const anchorText = document.getElementById("anchorInput").value.trim();

      if (anchorText !== "") {
        anchors.push({ date: today, text: anchorText });
        localStorage.setItem("riseAnchors", JSON.stringify(anchors));
      }

      updateStreakDisplay();
      loadWeeklyReview();

      alert("Session complete. Progress made ‚Äî even if recall felt messy.");
    }

    // --- Convenience helpers ---
    function clearTextboxes() {
      const ids = [
        "intentInput", "retrieveInput", "summaryInput", "contrastInput",
        "reallifeInput", "olderRecallInput", "anchorInput", "teachInput", "applyInput"
      ];
      ids.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = "";
      });
      alert("Text cleared. Your streak and weekly anchors are still saved.");
    }

    // Initialize UI on load
    renderTime();
    updateStreakDisplay();
    loadWeeklyReview();
  </script>
</body>
</html>
